local spawner = loadstring(game:HttpGet("https://raw.githubusercontent.com/RegularVynixu/Utilities/main/Doors/Entity%20Spawner/V2/Source.lua"))()
local entity = spawner.Create({
	Entity = {
		Name = "A60",
		Asset = "rbxassetid://83115631769066",
		HeightOffset = 0
	},
	Lights = {
		Flicker = {
			Enabled = false,
			Duration = 1
		},
		Shatter = true,
		Repair = false
	},
	Earthquake = {
		Enabled = false
	},
	CameraShake = {
		Enabled = true,
		Range = 100,
		Values = {9, 20, 0.1, 1} -- Magnitude, Roughness, FadeIn, FadeOut
	},
	Movement = {
		Speed = 400,
		Delay = 5,
		Reversed = false
	},
	Rebounding = {
		Enabled = true,
		Type = "Ambush", -- "Blitz"
		Min = 4,
		Max = 8,
		Delay = 0.5
	},
	Damage = {
		Enabled = true,
		Range = 100,
		Amount = 0.01
	},
	Crucifixion = {
		Enabled = true,
		Range = 40,
		Resist = false,
		Break = true
	},
	Death = {
		Type = "Guiding", -- "Curious"
		Hints = {"Death", "Hints", "Go", "Here"},
		Cause = ""
	}
})

local death = false -- Biến kiểm soát khi người chơi chết
local isTweenRunning = false

game.Lighting.MainColorCorrection.TintColor = Color3.fromRGB(60, 0, 0)
game.Lighting.MainColorCorrection.Contrast = 1
local tween = game:GetService("TweenService")
tween:Create(game.Lighting.MainColorCorrection, TweenInfo.new(2.5), {Contrast = 0}):Play()
local TweenService = game:GetService("TweenService")
local TW = TweenService:Create(game.Lighting.MainColorCorrection, TweenInfo.new(20),{TintColor = Color3.fromRGB(255, 255, 255)})
TW:Play()

local CameraShaker = require(game.ReplicatedStorage.CameraShaker)
local camara = game.Workspace.CurrentCamera
local camShake = CameraShaker.new(Enum.RenderPriority.Camera.Value, function(shakeCf)
	camara.CFrame = camara.CFrame * shakeCf
end)
camShake:Start()
camShake:ShakeOnce(50,35,0,2,1,6)

local CameraShaker = require(game.ReplicatedStorage.CameraShaker)
local camara = game.Workspace.CurrentCamera
local camShake = CameraShaker.new(Enum.RenderPriority.Camera.Value, function(cf)
	camara.CFrame = camara.CFrame * cf
end)

camShake:Start()
camShake:Shake(CameraShaker.Presets.Earthquake)


---====== Debug entity ======---

entity:SetCallback("OnSpawned", function()
	-- Get a reference to the object and its Attachment in the Workspace
	local part = workspace:WaitForChild("A60")
	local object = part:WaitForChild("RushNew") -- Replace "MyObjectName" with the name of your object
	local attachment = object:WaitForChild("ImageFace")  -- Get the Attachment attached to the object
	local e = attachment:WaitForChild("Face")

	object.CanCollide = false
	-- Get the ParticleEmitter attached to the Attachment
	while true do
		e.Texture = "rbxassetid://16020415559"
		wait(0)
		e.Texture = "rbxassetid://16020423090"
		wait(0)
		e.Texture = "rbxassetid://16020425703"
		wait(0)
		e.Texture = "rbxassetid://16020417711"
		wait(0)
		e.Texture = "rbxassetid://16020432826"
		wait(0)
		e.Texture = "rbxassetid://16020430685"
		wait(0)
		e.Texture = "rbxassetid://16020435171"
		wait(0)
		e.Texture = "rbxassetid://11378285585"
		wait(0)
	end
end)

entity:SetCallback("OnDespawning", function()
	wait(0.7)
	local CameraShaker = require(game.ReplicatedStorage.CameraShaker)
	local camara = game.Workspace.CurrentCamera
	local camShake = CameraShaker.new(Enum.RenderPriority.Camera.Value, function(shakeCf)
		camara.CFrame = camara.CFrame * shakeCf
	end)
	camShake:Start()
	camShake:ShakeOnce(50,50,0,2,1,6)

	game.Lighting.MainColorCorrection.TintColor = Color3.fromRGB(60, 0, 0)
	local TweenService = game:GetService("TweenService")
	local a = TweenService:Create(game.Lighting.MainColorCorrection, TweenInfo.new(5),{TintColor = Color3.fromRGB(0, 0, 0)})
	local b = TweenService:Create(game.Lighting.MainColorCorrection, TweenInfo.new(5),{TintColor = Color3.fromRGB(0, 60, 0)})
	local c = TweenService:Create(game.Lighting.MainColorCorrection, TweenInfo.new(10),{TintColor = Color3.fromRGB(100, 0, 0)})
	local d = TweenService:Create(game.Lighting.MainColorCorrection, TweenInfo.new(10),{TintColor = Color3.fromRGB(255, 255, 255)})

	a:Play()
	wait(5)
	b:Play()
	wait(5)
	c:Play()
	wait(5)
	d:Play()
end)

entity:SetCallback("OnDamagePlayer", function(newHealth)
	if newHealth == 0 then
		if death then return end -- tránh chạy nhiều lần
		death = true
		
		local player = game.Players.LocalPlayer
		local humanoid = player.Character and player.Character:FindFirstChildOfClass("Humanoid")
		if not humanoid then return end
		
		humanoid.WalkSpeed = 0
		
		-- Tween entity đứng trước mặt player liên tục
		local tweenService = game:GetService("TweenService")
		local camera = workspace.CurrentCamera
		local entityPart = workspace:WaitForChild("A60"):WaitForChild("RushNew")
		
		local tweenLoop = task.spawn(function()
			while death do
				task.wait(0.03)
				local tween = tweenService:Create(entityPart, TweenInfo.new(0.1), {
					CFrame = camera.CFrame * CFrame.new(0, -0.5, -6)
				})
				tween:Play()
				humanoid.WalkSpeed = 0
			end
		end)
		
		-- Delay 3s rồi gây damage cho player chết
		task.spawn(function()
			wait(3)
			humanoid:TakeDamage(125)
		end)
		
		-- Phát jumpscare GUI + âm thanh (copy nguyên đoạn của bạn)
		local function GetGitSound(url, name)
			if not isfile(name .. ".mp3") then
				writefile(name .. ".mp3", game:HttpGet(url))
			end
			local sound = Instance.new("Sound")
			sound.SoundId = (getcustomasset or getsynasset)(name .. ".mp3")
			sound.Volume = 6
			sound.PlaybackSpeed = 1
			sound.Parent = workspace
			return sound
		end
		
		local jumpSound = GetGitSound("https://github.com/eoyoustme/Monoxide/blob/main/lv_0_20250103234053.mp3?raw=true", "A60")
		jumpSound:Play()
		
		local gui = Instance.new("ScreenGui")
		gui.Name = "JumpscareGui"
		gui.IgnoreGuiInset = true
		gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
		gui.Parent = player:WaitForChild("PlayerGui")
		
		local background = Instance.new("Frame", gui)
		background.Size = UDim2.new(1, 0, 1, 0)
		background.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
		background.BorderSizePixel = 0
		background.BackgroundTransparency = 1
		background.ZIndex = 999
		
		local imageLabel = Instance.new("ImageLabel", gui)
		imageLabel.Size = UDim2.new(0, 0, 0, 0)
		imageLabel.AnchorPoint = Vector2.new(0.5, 0.5)
		imageLabel.Position = UDim2.new(0.5, 0, 0.5, 0)
		imageLabel.Image = "rbxassetid://12145534911"
		imageLabel.ImageTransparency = 1
		imageLabel.BackgroundTransparency = 1
		imageLabel.ImageColor3 = Color3.fromRGB(255, 255, 255)
		imageLabel.ZIndex = 999
		
		local tweenInfo = TweenInfo.new(0.1, Enum.EasingStyle.Linear)
		tweenService:Create(imageLabel, tweenInfo, {
			Size = UDim2.new(0, 580, 0, 580),
			ImageTransparency = 0,
			Rotation = math.random(10, 10)
		}):Play()
		
		local faces = {
			"12145534911", "12145554242", "12145599498", "12145599275", "12155335619",
			"12145598814", "12146135062", "11378285585", "1972219024", "1822114127",
			"3413871766", "3354536350", "17865063", "4749623118", "1857893092",
			"4508624823", "6309704436", "10458678325"
		}
		
		local running = true
		task.spawn(function()
			while running do
				imageLabel.Image = "rbxassetid://" .. faces[math.random(1, #faces)]
				task.wait(0.07)
			end
		end)
		
		wait(0.4)
		tweenService:Create(background, TweenInfo.new(2), {BackgroundTransparency = 1}):Play()
		tweenService:Create(imageLabel, TweenInfo.new(1.5), {ImageTransparency = 0.1}):Play()
		
		task.wait(2)
		running = false
		gui:Destroy()
		jumpSound:Destroy()
		
		-- Sau jumpscare có thể reset hoặc giữ chết tùy bạn
		-- Ví dụ:
		humanoid.WalkSpeed = 0
	end
end)

---====== Run entity ======---

entity:Run()
